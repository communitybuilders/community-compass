{"version":3,"sources":["autocomplete-address.js","google-map.js","infinitescroll.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["$(function () {\n    'use strict';\n\n    // Only run this js on the index page.\n    if (!$('body').is('#organisations-index')) {\n        return;\n    }\n\n    var input = $('#autocomplete')[0];\n    var options = {\n        types: ['address']\n    };\n\n    var autocomplete = new google.maps.places.Autocomplete(input, options);\n\n    google.maps.event.addListener(autocomplete, 'place_changed', function() {\n        var addressParts = {\n            street_number: 'long_name',\n            route: 'long_name',\n            locality: 'long_name',\n            administrative_area_level_1: 'short_name',\n            country: 'long_name',\n            postal_code: 'short_name'\n        };\n        var place = autocomplete.getPlace();\n        var type;\n        var name;\n\n        // TODO: use geocode to display map marker.\n        if (place.geometry && place.geometry.location) {\n            $('#lat').val(place.geometry.location.lat());\n            $('#lng').val(place.geometry.location.lng()).trigger('change');\n        }\n\n    });\n\n});\n","$(function () {\n\n    // Only run this js on the index page.\n    if (!$('body').is('#organisations-index')) {\n        return;\n    }\n\n    var mapCanvas = $('#canvas');\n    var mapOptions = {\n        mapTypeControl: false,\n        //mapTypeId: google.maps.MapTypeId.HYBRID,\n        overviewMapControl: true,\n        panControl: false,\n        scaleControl: false,\n        streetViewControl: true,\n        zoom: 16,\n        zoomControl: true\n    };\n    var map = new google.maps.Map(mapCanvas[0], mapOptions);\n    var marker = new google.maps.Marker();\n    var markersArray = [];\n    var infoWindow = new google.maps.InfoWindow();\n    var latLng;\n\n    google.maps.event.addListener(marker, 'click', function() {\n        infoWindow.setContent('<p>' + $('#autocomplete').val() + '</p>');\n        infoWindow.open(map, marker);\n    });\n\n    var addNearbyMarker = function(lat, lng, orgInfo) {\n        var nearbyLatLng = new google.maps.LatLng(lat, lng);\n        var nearbyMarker = new google.maps.Marker({\n            position: nearbyLatLng,\n            map: map\n        });\n\n        google.maps.event.addListener(nearbyMarker, 'click', function() {\n            var infoContainer = $('.info-window').first();\n\n            var content = '<div class=\"info-window\">' +\n                '<div class=\"image-container pull-left\">';\n\n            if (orgInfo.image) {\n                content += '<img style=\"max-height: 100px; max-width: 100px;\" src=' + orgInfo.image.image_uri + '>';\n            } else {\n                content += '<img src=\"http://placehold.it/100x100\">';\n            }\n\n            content += '<div class=\"info-actions text-center\">' +\n                '<a href=\"info-claim\">C</a>' +\n                '<a href=\"info-like\">L</a>' +\n                '<a href=\"info-subscribe\">S</a>' +\n                '<a href=\"info-donate\">D</a>' +\n                '</div>' +\n                '</div>' +\n                '<div class=\"pull-left\">' +\n                '<p class=\"info-legal-name\">' + orgInfo.legal_name + '</p>';\n\n            if (orgInfo.website) {\n                content += '<p class=\"info-website\"><a href=\"' + orgInfo.website.url + '\">' + orgInfo.website.url + '</a></p>';\n            }\n\n            content += '<p><span class=\"info-address.address-1\">' + orgInfo.address_line_1 + ' ' + orgInfo.address_line_2 + ' ' + orgInfo.address_line_3 + '</span><br>' +\n                '<span class=\"info-address.address-2\">' + orgInfo.suburb + ' ' + orgInfo.state + ' ' + orgInfo.state + '</span>' +\n                '</p>' +\n                '</div>' +\n                '</div>';\n\n            infoWindow.setContent(content);\n            infoWindow.open(map, nearbyMarker);\n            infoContainer.show();\n        });\n\n        markersArray.push(nearbyMarker);\n    };\n\n    var updateMap = function(lat, lng) {\n        infoWindow.close();\n\n        marker.setMap(null);\n        for (var i = 0; i < markersArray.length; i++) {\n            markersArray[i].setMap(null);\n        }\n        markersArray = [];\n\n        latLng = new google.maps.LatLng(lat, lng);\n        map.setCenter(latLng);\n        marker.setIcon('http://maps.google.com/mapfiles/marker_green.png');\n        marker.setPosition(latLng);\n        marker.setMap(map);\n    };\n\n    var getNearbyOrganisations = function(lat, lng, skip, take) {\n\n        $.ajax({\n            type: 'POST',\n            url: 'organisations/closest',\n            headers: {\n                'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content')\n            },\n            data: {\n                'lat': lat,\n                'lng': lng,\n                'skip': skip,\n                'take': take\n            },\n            success: function(results) {\n                $.each(results, function (index, result) {\n                    addNearbyMarker(result.lat, result.lng, result);\n                });\n            }\n        });\n\n    };\n\n    $('#lat, #lng').on('change', function() {\n        updateMap($('#lat').val(), $('#lng').val());\n        getNearbyOrganisations($('#lat').val(), $('#lng').val(), 0, 10);\n    });\n\n    var defaultLoc = {\n        lat: -33.8132992,\n        lng: 151.0094947\n    };\n    updateMap(defaultLoc.lat, defaultLoc.lng);\n\n\n});\n","$(function () {\n\n    // Only run this js on the organisations index page.\n    if (!$('body').is('#organisations-index')) {\n        return;\n    }\n\n    var current_row = 24;\n    var increment = 24;\n\n    var getNearbyOrganisations = function (lat, lng) {\n        $.ajax({\n            type: \"POST\",\n            url: \"organisations/closest\",\n            data: {\n                '_token':$('input[name=_token]').val(),\n                'lat': lat,\n                'lng': lng,\n                'skip': current_row,\n                'take': increment\n            },\n\n            success: function(data) {\n                current_row = current_row + increment;\n                var result = data;\n                var display =\"\";\n\n                $(result).each(function(index, value){\n                    display +=\"<div class='col-xs-6 col-md3 col-md-3 col-lg-3' style='float:left;'>\";\n                    display +=\"<div class='panel panel-default' style='height:500px'>\";\n                    if (value.image){\n                        display +=\"<img class='img-responsive center-block' style='width:100%; height:252px' src=\" + value.image.image_uri +\" alt='image'><br />\";\n                    }else{\n                        display +=\"<img class='img-responsive center-block' style='width:100%' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAANlBMVEXMzMzPz8+RkZHExMSampqQkJDKysqfn5/Hx8e7u7vDw8OUlJS4uLiXl5esrKypqamzs7Ojo6OgzyMdAAACGUlEQVR4nO3V247cIBAEUJqLAXP//59NNR5npd1IeQl5qiNZYhgsaqBhjCEiIiIiIiIiIiIiIiIiIiIiIiIiIiIiOklE3sa3jp8D5fsbfx75T+URe9LJ8lp1zzrjuv80cV9r7v4eh75hUn9ePWraFot3aBTvgybs1rfwc96EYd52tNAoHgOcb9Gu62y+5H2WbqekVVL2XsztY5plvJv57rxMOy6MviWj0csU9EwTWz4b8Mq3MRUBkQshQ5LaOj74vTB1TNFH264mIxEBNdxth5GFDxryuCuGLFkXbdgss1S5EARfyAj+XsG/BYnw/pLVsiS7krT4LOfxgLF0zG27YK91v6vIExC9Zfjx+8BkX25dxWwkLCcBAd35gFfHaug274D1DfgprVba/Y68Izb3E9DGHdD8h4A4vXqp5NKfLdaA5rOCBgX3FSCWoV1Lz4XFChas4H084O3DXqzchlzDouyxTDit7gn4XCi7OfdKozBRg05rUI903RfPQZdeMXqRYP9EHyRdos8OpTXY5fNLkEd20L4fGThOo+SzfybJt1lrxTb10gemNddqfdn8hnKIsE/0bDHXiv7U/PRambnFWaI7ms+4YgNgujRs2f9gbtk29pe4Zga2POg5Rm3qSFw5kqNt+/arPsTD9zTibNq6nHvqPb0NtJJ2p0/vOzK59PU9EREREREREREREREREREREREREREREf3NL2UnEmIOKkswAAAAAElFTkSuQmCC' alt='image'><br />\";\n                    }display +=\"<div id='org_actions' style='padding-left:17px; padding-right: 17px;'>\"\n                    display += value.legal_name + \"<br />\";\n                    if ($('#auth').val().length) {\n                        display +=\"<a href='#' id='claim-{{$value->id}}' name='claim' data-toggle='modal' data-target='#claim' class='claim_link'><span class='fa fa-plus-square'> Claim</span></a><br />\";\n                        display +=\"<a href='#' id='like-{{$value->id}}' name='like' data-toggle='modal' data-target='#liked'><span class='fa fa-heart'> Like</span></a><br />\";\n                        display +=\"<a href='#' id='share-{{$value->id}}' name='share' data-toggle='modal' data-target='#share'><span class='fa fa-share-square-o'> Share</span></a><br />\";\n                        display +=\"<a href='#' id='donate-{{$value->id}}' name='donate' data-toggle='modal' data-target='#donate'><span class='fa fa-usd'> Donate</span></a><br />\";\n                        display +=\"<a href='#' id='volunteer-{{$value->id}}' name='volunteer' data-toggle='modal' data-target='#volunteer'><span class='fa fa-group'> Volunteer</span></a><br />\";\n                        display +=\"<a href='#' id='partner-{{$value->id}}' name='partner' data-toggle='modal' data-target='#partner'><span class='fa fa-exchange'> Partner</span></a><br />\";\n                        display +=\"<a href='#' id='contact-{{$value->id}}' name='contact' data-toggle='modal' data-target='#contact'><span class='fa fa-envelope'> Contact</span></a><br />\";\n                    }else{\n                        display +=\"<a href='#' id='claim-{{$value->id}}' name='claim' data-toggle='modal' data-target='#claim' class='claim_link'><span class='fa fa-plus-square'> Claim</span></a><br />\";\n                        display +=\"<a href='/auth/login' ><span class='fa fa-heart'> Like</span></a><br />\";\n                        display +=\"<a href='/auth/login' ><span class='fa fa-share-square-o'> Share</span></a><br />\";\n                        display +=\"<a href='/auth/login' ><span class='fa fa-usd'> Donate</span></a><br />\";\n                        display +=\"<a href='/auth/login' ><span class='fa fa-group'> Volunteer</span></a><br />\";\n                        display +=\"<a href='/auth/login' ><span class='fa fa-exchange'> Partner</span></a><br />\";\n                        display +=\"<a href='/auth/login' ><span class='fa fa-envelope'> Contact</span></a><br />\";\n                    }\n\n                    display +=\"</div>\";\n                    display +=\"</div>\";\n                    display +=\"</div>\";\n\n                });\n\n                $(\".organisations_div\").append(display);\n            }\n        });\n    };\n\n    $('#lat, #lng').on('change', function() {\n        current_row = 0;\n        $('.organisations_div').empty();\n        getNearbyOrganisations($('#lat').val(), $('#lng').val());\n    });\n\n\n    $(window).scroll(function() {\n        if(($(window).scrollTop() + $(window).height()) == $(document).height()) {\n            setTimeout(function(){\n                getNearbyOrganisations($('#lat').val(), $('#lng').val());\n            }, 200);\n        }\n\n    });\n\n    $(document).on(\"click\", \".claim_link\", function () {\n        var claim_form = $(\"#claim_organisation_form\");\n\n        // Set the value of the organisation we're going to submit on\n        // our form's hidden organisation_id element.\n        var organisation_id = $(this).attr('id').replace(\"claim-\", \"\");\n        $(\"#claim_organisation_id\").val(organisation_id);\n\n        if( $(\"#but_claim_already_logged_in\").length > 0 ) {\n            // We're already logged in as this button exists.\n            // Let's just submit the form.\n            claim_form.submit();\n        }\n    });\n});\n"],"sourceRoot":"/source/"}